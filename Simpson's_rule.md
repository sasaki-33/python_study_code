

# シンプソン積分
数値解析の分野における、数値積分の方法の一つである。  
[シンプソンの公式] https://ja.wikipedia.org/wiki/%E3%82%B7%E3%83%B3%E3%83%97%E3%82%BD%E3%83%B3%E3%81%AE%E5%85%AC%E5%BC%8F

## 目次
1. 例題
2. 問題の定式化
3. 問題解決方法
4. アルゴリズム
5. プログラム設計
6. 実行結果  
***
### 1.例題
(被積分関数) *√1-x^2*  
(積分区間) *0~1*  
上記の条件でシンプソン積分を用いて、有効桁数9桁の積分値を求める


### 2.問題の定式化
* 積分区間の分割数を変化させる
* シンプソン積分を行う
* 有効桁数9桁の確保


### 3.問題解決方法
1. 積分対象となる関数の曲線をいくつかの区間に区切って放物線で近似する  
積分区間のある二点aからbの区間を2n等分し、h=(b-a)/2nを求め、a,a+h,a+2h...bに相当する積分対象f(x)の値をy0,y1,y2...とした時、積分値の近似値Aは次の式で求められる  
_A = h/3Σ(y2i+4*y2i+1+y2i+2) (数列和のiは0~n-1の範囲)_

2. 分割数nの初期値を2とし、2ずつ増加させる
3. 分割数nの時の積分値をAnとしたとき、分割数n+1の時の積分値をA(n+1)とする
4. それぞれの値AnとA(n+1)に、10^9を乗じ、小数点を切り捨てた結果が一致すれば終了


### 4.アルゴリズム
1. 分割数を表す二つの変数NxとNyを用意し、それぞれに初期値2と4を設定する
2. 分割数がNxの時の積分値をAxに設定する
3. 分割数がNyの時の積分値をAyに設定する
4. NxにNyを設定する
5. NyにNy+2の値を設定する
6. AxとAyに10^9を乗じる(有効桁数が9桁で求めるため)
7. AxとAyの小数点以下を切り捨てる
8. AxとAyを比較し、一致するまで、2~8の処理を繰り返す
9. 一致すれば、10^9で割り題意の有効桁数9桁の積分値を得られる


### 5.プログラム設計
1. mathモジュールを使用する
2. 使用する変数は分割数を表すNx(初期値2),Ny(初期値4)を使用する
3. 関数simpsonを作成し、引数を分割数とし、返却値はAxに10^9を乗じ小数点を切り捨てた値とする
4. While文を用いて、分割数がNxとNyの時の関数simpsonの返却値が一致するまで繰り返す
5. 一致した時の分割数と題意を満たす積分値を出力する

```py:Simpson's rule.py
import math

#シンプソン積分を求め10^9し、小数点を切り捨てる関数の定義
def simpson(a):
    i = 0
    kekka = 0
    h = 1/(2*a)
    
    #被積分関数の計算を行う関数の定義
    def kansuu(b):
        c = 0
        if b == 0:
            c = 1
        else:
            c = math.sqrt(1-((b*h)**2))
        return c
    
    while i < a :
        kekka = kekka + kansuu(2*i) + 4*kansuu(2*i+1) + kansuu(2*i+2)
        i += 1
    
    final_a = (kekka*h)/3
    final_b = math.floor(final_a*(10**9))
    return final_b

#分割数の初期値を設定
Nx = 2
Ny = Nx + 2

#積分値が一致するまで分割数を増やす
while simpson(Nx) != simpson(Ny) :
    Nx = Ny
    Ny = Ny + 2

#10^9で割り、元の積分値に戻す
rule = simpson(Nx)/(10**9)

#結果の表示
print('一致した分割数は{}である。'.format(Nx))
print('題意を満たす積分値は{}である。'.format(rule))
```
### 6.実行結果
数値が一致した分割数は*1746*、積分値は*0.785397607*となった。